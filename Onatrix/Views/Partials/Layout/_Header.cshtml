@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage

@using Umbraco.Cms.Core.Models.PublishedContent
@using Umbraco.Cms.Core.PublishedCache
@using Umbraco.Cms.Core.Routing
@using Umbraco.Cms.Core.Services.Navigation

@inject IVariationContextAccessor VariationContextAccessor
@inject IPublishedContentCache PublishedContentCache
@inject IDocumentNavigationQueryService DocumentNavigationQueryService
@inject IPublishedValueFallback PublishedValueFallback
@inject IPublishedUrlProvider PublishedUrlProvider
@*
    This snippet displays a list of links of the pages immediately under the top-most page in the content tree.
    This is the home page for a standard website.
    It also highlights the current active page/section in the navigation with the CSS class "current".
*@

@{
    var rootContent = Umbraco.ContentAtRoot();
    var siteSettings = rootContent.OfType<SiteSettings>().FirstOrDefault();
    var logo = siteSettings?.SiteLogo;

    var selection = Model.Root().Children().Where(x => x.IsVisible(PublishedValueFallback)).ToArray();
}

<header class="relative shadow-sm z-999">

    <nav class="max-w-7xl mx-auto flex items-center justify-between p-4">
        @if (logo != null)
        {
            <a href="/" class="shrink-0">
                <img src="@logo.Url()" alt="Onatrix Logo" class="h-10" />
            </a>
        }
        else {
            <a href="/" class="shrink-0">
                <h1 class="text-2xl font-bold">Onatrix</h1>
            </a>
        }

        @if (selection?.Length > 0)
        {
            <div class="relative flex items-center">
                <ul id="nav-menu" class="hidden absolute top-full right-0 w-48 bg-neutral shadow-md rounded-lg flex-col items-start p-4 gap-4 
                                        md:gap-16 md:p-0 md:bg-transparent md:shadow-none md:static md:flex md:flex-row md:items-center md:w-auto">
                    @foreach (var item in selection)
                    {
                        <li class="@(item.IsAncestorOrSelf(Model) ? "current" : null)">
                            <a class="font-bold py-2 text-primary hover:text-secondary transition-colors block w-full" href="@item.Url(PublishedUrlProvider)">
                                @item.Name
                            </a>
                        </li>
                    }
                </ul>

                <button 
                    id="menu-toggle" 
                    class="ml-auto md:hidden flex items-center justify-center p-2 text-primary hover:text-secondary focus:outline-none transition-colors"
                    aria-label="Toggle navigation">
                    <i class="fa-solid fa-bars text-2xl"></i>
                </button>

                <div class="md:hidden">
                    <i class="fa-solid fa-magnifying-glass text-lg text-primary cursor-pointer"></i>
                </div>
            </div>

            <script>
                document.addEventListener("DOMContentLoaded", function () {
                    const toggle = document.getElementById("menu-toggle");
                    const menu = document.getElementById("nav-menu");

                    toggle.addEventListener("click", function () {
                        menu.classList.toggle("hidden");
                    });
                });
            </script>
        }

        <div class="hidden md:block">
            <i class="fa-solid fa-magnifying-glass text-lg text-primary cursor-pointer"></i>
        </div>
    </nav>

</header>